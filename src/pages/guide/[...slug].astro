---
import { type CollectionEntry, getCollection } from 'astro:content';
import GuideLayout from '../../layouts/GuideLayout.astro';

export async function getStaticPaths() {
  const guides = await getCollection('guide');
  return guides.map((guide) => ({
    params: { slug: guide.slug },
    props: { guide, guides },
  }));
}

type Props = {
  guide: CollectionEntry<'guide'>;
  guides: CollectionEntry<'guide'>[];
};

const { guide, guides } = Astro.props;
const { Content } = await guide.render();

// Pre-renderizar el contenido de las primeras guÃ­as
const initialGuides = await Promise.all(
  guides.slice(0, 5).map(async (g) => {
    const { Content } = await g.render();
    return { ...g, content: Content };
  })
);

type GuideWithContent = CollectionEntry<'guide'> & { content: any };
---

<GuideLayout title={guide.data.title} description={guide.data.description}>
  <Content />
</GuideLayout>